运行环境：

在pycharm可以直接运行。

实现方法：

这段代码是一个使用椭圆曲线数字签名算法的实现。下面是对代码各部分的解析：

gcd(a,b)：计算a和b的最大公约数。

xgcd(a, m)：计算a关于模m的乘法逆元，即满足 (a * x) % m = 1 的x。

epoint_add(P,Q)：椭圆曲线上两点P和Q的相加操作。

epoint_mul(k, g)：椭圆曲线上k倍点运算，即将点g加上自身k次。

signature(m)：生成消息m的数字签名。首先生成一个随机数k，计算曲线上的点Z为k倍点g。然后计算签名的r值为Z[0]对n取模，其中n为椭圆曲线的阶。接着计算e为消息m的哈希值，计算签名的s值为 (xgcd(k,n) * (e + d * r)) % n，其中d为私钥。返回签名的r和s值。

verify(r,s)：验证数字签名的有效性。根据签名中的r和s，计算e为消息m的哈希值，并计算t为s的乘法逆元mod n。根据公钥pk和r，通过点运算计算出Z。如果Z非零且Z[0]对n取模等于r，则返回True，否则返回False。

attack(e,r,s)：模拟攻击者尝试伪造数字签名。根据攻击者已知的e、r和s值，计算t为s的乘法逆元mod n。通过点运算计算出Z，如果Z非零且Z[0]对n取模等于r，则返回True，表示攻击成功，否则返回False，表示攻击失败。

forge_signature(r,s)：尝试伪造数字签名。生成两个随机数a和b，通过点运算得到点Z。计算伪造消息e1为 r1 * a * xgcd(b, n) % n，计算伪造签名s1为 r1 * xgcd(b, n) % n，其中r1为Z[0]对n取模。输出伪造的消息和签名，并调用attack函数验证伪造签名的有效性。

最后，代码定义了一些常量和变量，包括椭圆曲线参数(a,b,p)，基点g的坐标(x,y)，椭圆曲线的阶n，消息m，私钥d和公钥pk。接着进行数字签名的生成和验证，并进行伪造签名的尝试。

运行结果：

<img width="416" alt="image" src="https://github.com/TraceAJ/project19/assets/110471272/263a051e-bb6b-4e5c-b568-0d64688c4bb2">
